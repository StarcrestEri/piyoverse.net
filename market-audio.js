!function(){try{if(window.__legacy_low_end)return}catch(E){}(function(){try{return(location.pathname||"").split("/").pop().toLowerCase()}catch(t){return""}})().indexOf("marketplace");var t=function(){try{var t=localStorage.getItem("site-music");return null===t?"on":t}catch(t){return"on"}}(),e=function(){try{var t=localStorage.getItem("site-sfx");return null===t?"on":t}catch(t){return"on"}}();window.siteMusicEnabled="on"===t,window.siteSfxEnabled="on"===e;var n,c=null,a=null,r=.65,i=null;function o(){if(c)return c;try{var t=document.getElementById("piyoverse-music");if(t){c=t;try{c.loop=!0}catch(t){}return c}}catch(t){}(c=document.createElement("audio")).id="piyoverse-music",c.loop=!0,c.preload="auto",c.volume=0;try{for(var e="/Audio/DOS",n=[[e+".mp3","audio/mpeg"],[e+".ogg","audio/ogg"],[e+".wav","audio/wav"]],a=0;a<n.length;a++){var r=document.createElement("source");r.src=n[a][0],r.type=n[a][1],c.appendChild(r)}}catch(t){c.src="/Audio/DOS.mp3"}c.setAttribute("aria-hidden","true"),document.body.appendChild(c);try{u(c)}catch(t){}try{var i=sessionStorage.getItem("market-music-time");null===i||isNaN(i)||(c.currentTime=parseFloat(i))}catch(t){}return c}function u(t){try{if(!t)return;try{t.removeEventListener("play",u.__playFn)}catch(t){}try{t.removeEventListener("pause",u.__pauseFn)}catch(t){}u.__playFn=function(){try{l(!0)}catch(t){}},u.__pauseFn=function(){try{l(!1)}catch(t){}};try{t.addEventListener("play",u.__playFn)}catch(t){}try{t.addEventListener("pause",u.__pauseFn)}catch(t){}}catch(t){}}function d(){try{function t(){try{if(c){var e=c.play&&c.play();e&&e.then&&e.then(function(){c.pause&&c.pause()}).catch(function(){})}else try{var n=new(window.AudioContext||window.webkitAudioContext),a=n.createOscillator(),r=n.createGain();a.connect(r),r.connect(n.destination),r.gain.value=0,a.start(0),a.stop(0)}catch(t){}}catch(t){}try{document.removeEventListener("pointerdown",t),document.removeEventListener("keydown",t)}catch(t){}}document.addEventListener("pointerdown",t,{once:!0,passive:!0}),document.addEventListener("keydown",t,{once:!0,passive:!0})}catch(e){}}function s(t,e){if(c){a&&(clearInterval(a),a=null);var n=Math.max(6,Math.round((e||600)/80)),r=c.volume,i=(t-r)/n,o=0;a=setInterval(function(){o++;var e=Math.max(0,Math.min(1,c.volume+i));if(c.volume=e,o>=n&&(clearInterval(a),a=null,0===t))try{c.pause()}catch(t){}},Math.round((e||600)/n))}}function l(t){try{localStorage.setItem("site-music-playing",t?"1":"0")}catch(t){}}window.siteEnsureMusicPlaying=function(){try{if(!window.siteMusicEnabled)return;var t=o();try{!0!==t.loop&&(t.loop=!0)}catch(t){}var e=null;try{e=t.play&&t.play()}catch(t){e=null}if(e&&e.then)e.then(function(){try{s(r,900)}catch(t){}}).catch(function(){});else if(null===e)try{document.addEventListener("pointerdown",function e(){try{t.play&&t.play(),s(r,900)}catch(t){}try{document.removeEventListener("pointerdown",e)}catch(t){}},{once:!0})}catch(t){}else try{s(r,900)}catch(t){}try{i&&clearInterval(i),i=setInterval(function(){try{c&&!c.paused&&sessionStorage.setItem("market-music-time",String(c.currentTime))}catch(t){}},1e3)}catch(t){}d();try{l(!0)}catch(t){}}catch(t){}};try{var y=!1;try{y="1"===localStorage.getItem("site-music-playing")}catch(L){}if(window.siteMusicEnabled&&window.siteEnsureMusicPlaying)if(y)try{window.siteEnsureMusicPlaying()}catch(S){}else try{o()}catch(_){}}catch(b){}try{window.addEventListener&&window.addEventListener("storage",function(t){try{if(!t||!t.key)return;if("site-music"===t.key){try{window.siteMusicEnabled="on"===localStorage.getItem("site-music")}catch(t){}if(window.siteMusicEnabled)try{window.siteEnsureMusicPlaying&&window.siteEnsureMusicPlaying()}catch(t){}else{try{var e=document.getElementById("piyoverse-music");if(e)try{e.pause(),e.volume=0}catch(t){}}catch(t){}try{l(!1)}catch(t){}}}}catch(t){}},!1)}catch(I){}if(window.siteMusicEnabled)try{var h=o(),v=null,m=!1;try{v=h.play&&h.play()}catch(M){v=null}function p(){try{if(!m)return;var t=h.play&&h.play();t&&t.then?t.then(function(){m=!1,s(r,900),f()}).catch(function(){}):(m=!1,s(r,900),f())}catch(t){}}function f(){try{document.removeEventListener("pointerdown",p),document.removeEventListener("keydown",p)}catch(t){}}v&&v.then?v.then(function(){s(r,900);try{l(!0)}catch(t){}}).catch(function(){m=!0}):null===v?m=!0:s(r,900),m&&(document.addEventListener("pointerdown",p,{once:!0}),document.addEventListener("keydown",p,{once:!0})),d();try{i&&clearInterval(i),i=setInterval(function(){try{c&&!c.paused&&sessionStorage.setItem("market-music-time",String(c.currentTime))}catch(t){}},1e3)}catch(x){}}catch(F){}window.addEventListener("beforeunload",function(){try{c&&s(0,500)}catch(t){}}),window.addEventListener("unload",function(){try{c&&sessionStorage.setItem("market-music-time",String(c.currentTime)),i&&clearInterval(i)}catch(t){}}),document.addEventListener("visibilitychange",function(){try{if(document.hidden)c&&s(0,400);else if(c&&window.siteMusicEnabled)try{var t=c.play&&c.play();t&&t.then?t.then(function(){s(r,600)}).catch(function(){}):s(r,600)}catch(t){try{s(r,600)}catch(t){}}}catch(t){}}),window.addEventListener("focus",function(){try{if(c&&window.siteMusicEnabled){var t=c.play&&c.play();t&&t.then?t.then(function(){s(r,600)}).catch(function(){}):s(r,600)}}catch(t){}});try{document.addEventListener&&c&&c.addEventListener&&c.addEventListener("play",function(){try{l(!0)}catch(t){}})}catch(k){}try{document.addEventListener&&c&&c.addEventListener&&c.addEventListener("pause",function(){try{l(!1)}catch(t){}})}catch(T){}n=0,document.addEventListener("pointerdown",function(t){try{if(!window.siteSfxEnabled)return;var e=Date.now();if(e-n<120)return;if(function(t){for(;t&&t!==document.documentElement;){try{if(t.classList&&(t.classList.contains("nav-item")||t.classList.contains("game-card")||t.classList.contains("btn")))return t}catch(t){}t=t.parentNode}return null}(t.target||t.srcElement)){n=e;try{window.playSiteSfx&&window.playSiteSfx("Audio/Navigation-Hover.ogg",{volume:.6})}catch(t){}}}catch(t){}},{passive:!0});try{function w(t){try{if(!window.siteSfxEnabled)return;if(t.currentTarget||t.target,window.playSiteSfx)try{window.playSiteSfx("Audio/Navigation-Hover.ogg",{volume:.6})}catch(t){}}catch(t){}}function g(){for(var t=document.querySelectorAll(".game-card"),e=0;e<t.length;e++)try{var n=t[e].__hoverFn||w;t[e].__hoverFn=n;try{t[e].removeEventListener("pointerenter",n)}catch(t){}t[e].addEventListener("pointerenter",n)}catch(t){}for(var c=document.querySelectorAll(".nav-item"),a=0;a<c.length;a++)try{var r=c[a].__hoverFn||w;c[a].__hoverFn=r;try{c[a].removeEventListener("pointerenter",r)}catch(t){}c[a].addEventListener("pointerenter",r)}catch(t){}for(var i=document.querySelectorAll(".btn, button"),o=0;o<i.length;o++)try{var u=i[o].__hoverFn||w;i[o].__hoverFn=u;try{i[o].removeEventListener("pointerenter",u)}catch(t){}i[o].addEventListener("pointerenter",u)}catch(t){}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",g):g();try{window.siteReinit=function(){try{g()}catch(t){}}}catch(A){}}catch(P){}window.playSiteSfx=function(t,e){try{if(!window.siteSfxEnabled)return;var n=t;try{n&&!/^(?:https?:|\/)/i.test(n)&&(n="/"+n.replace(/^\/+/,""))}catch(t){}try{var c=document.createElement("audio"),a=(t||"").match(/\.([a-z0-9]+)$/i);a&&"ogg"===a[1].toLowerCase()&&(c.canPlayType&&c.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")||(c.canPlayType&&c.canPlayType("audio/mpeg").replace(/^no$/,"")?n=n.replace(/\.ogg$/i,".mp3"):c.canPlayType&&c.canPlayType("audio/wav").replace(/^no$/,"")&&(n=n.replace(/\.ogg$/i,".wav"))))}catch(t){}var r=new Audio(n);r.preload="auto",r.volume=e&&"number"==typeof e.volume?e.volume:.9,r.play();try{setTimeout(function(){r.remove()},4e3)}catch(t){}}catch(t){}}}();